FPSI Patch for the Stylistic 3400
Release Notes

18 July 1999


The FPSI Patch for the Stylistic 3400 is a file called WINFPSI.DRV.  This
is a Windows device driver that corrects some of the shortcomings of
Windows 98 with Pen Services 2.0. Details concerning the features of
WINFPSI.DRV can be found below.


INSTALLATION INSTRUCTIONS

The FPSI Patch for should already be installed in your system. In most
cases, all you need to do is copy the file WINFPSI.DRV to the
\WINDOWS\SYSTEM subdirectory, replacing the WINFPSI.DRV that is already
there.  In some cases, you will also need to modify your SYSTEM.INI
file.  You will need to add "WINFPSI.DRV" at the end of the "device="
line in the [boot] section of SYSTEM.INI, so that SYSTEM.INI looks like:

    [boot]
    .
    .
    .
    drivers=<other drivers like mmsystem.dll, pen, etc.> WINFPSI.DRV
    .
    .
    .


CONFIGURATION

In general, it should not be necessary to configure the FPSI Patch.  The
default values are optimal for use with the Stylistic 3400.

The features of WINFPSI.DRV are controlled by entries in the
[FujitsuWinOptions] section of SYSTEM.INI.  If a particular entry is
missing, then the default value is used.  The following entries are
valid:


PenAware = [0|1]            Default = 1

    1: (default) Enable pen support for all applications
    0: Do not enable pen support

    Before enabling pen support for an application, Pen Services checks
    the application's flags in the Task Database (TDB) to determine if
    the application is pen aware.  Visual BASIC applications do not have
    the pen compatibility flag set in their TDB, so Pen Services does
    not display the "Lens Tool" (sometimes called the "A Button") in
    16-bit Visual BASIC applications.
    
    If the "PenAware" feature is enabled, WINFPSI.DRV hooks the
    IsPenAware() function call in Pen Services and forces this function
    to always return "TRUE" so than Pen Services believes that all
    applications are pen aware, and will therefore provide the Lens
    Tool for all applications.
    
    
MonitorPenTool = [0|1]      Default = 1

    1: (default) Prevent keyboard dialog popup if pen tool has been disabled
    0: Don't prevent keyboard dialog popup.  Allow GPF to occur.
    
    It is possible to disable the "Lens Tool" (sometimes called the "A
    Button" or the "Writing Tool") in the Handwriter Settings applet of
    the Control Panel, by un-checking the checkbox entitled "Enable
    pop-up letter guides (Writing Tool)" in the "General" tab.  When the
    Lens Tool is disabled, it should still be possible to bring up the
    Lens Tool Keyboard by making a "checkmark" gesture on the screen.
    However, due to a bug in Pen Services, making a "checkmark" gesture
    on the screen when the Lens Tool is disabled will cause a General
    Protection Fault (GPF).
    
    If the "MonitorPenTool" option is enabled, WINFPSI.DRV prevents this
    GPF from occurring, and instead displays an error message that
    states "Please enable the 'pop-up letter guides' option from the
    Control Panel before invoking the Screen Keyboard dialog."
    

CorrectTarget = [0|1]       Default = 1

    1: (default) Ensure that recognized characters are sent to the
       correct Edit control
    0: Let Pen Services decide where recognized characters are sent
    
    Pen Services has a function called TargetPoints() that decides where
    Edit control characters generated by handwriting recognition should
    be placed.  However, if Edit controls are closely stacked together,
    or if there are more than 64 Edit controls in a single window,
    TargetPoints() can become confused, sending the characters to the
    wrong Edit control.
    
    If the "CorrectTarget" option is enabled, WINFPSI.DRV pre-processes
    the data sent to TargetPoints(), ensuring that characters are sent to
    the correct Edit control.
    

IgnorePrograms = <ignore_programs_section>

    <ignore_programs_section> is the name of the Ignore Programs section
    of SYSTEM.INI.  The Ignore Programs section contains a list of
    programs that will be ignored by WINFPSI.DRV when correcting pen
    targets as described in the "CorrectTarget" section above.  An
    example of <ignore_programs_section>.
    
    The Ignore Programs section has the following format:
    
    0 = <ignore_program_1>
    1 = <ignore_program_2>
    2 = <ignore_program_3>

    .
    .
    .

    19 = <ignore_program_20>
    
    The following example shows how to exclude WordPad from being affected
    by the CorrectTargets patch.
    
    [FujitsuWinOptions]
    IgnorePrograms="FujitsuIgnorePrograms"
    
    [FujitsuIgnorePrograms]
    0="c:\program files\accessories\wordpad.exe"


ADDITIONAL ASSISTANCE

If you require additional assistance in installing or configuring the
FPSI Patch for Windows 98, please contact your local help desk or
reseller.  You can also contact your assigned FPSI Systems Engineer or
call FPSI Customer Support at one of the numbers listed in our Web site
at <http://www.fpsi.fujitsu.com/support/>.
